(()=>{"use strict";function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}var t=function(){function t(e,n,a,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this._tabsContainer=document.querySelector(e),this._tabsContentContainer=document.querySelector(n),this._tabsList=Array.from(this._tabsContainer.children),this._tabsContentList=Array.from(this._tabsContentContainer.children),this._activeTabSelector=a,this._activeTabContentSelector=r,this._activeTab=this._tabsContainer.querySelector(".".concat(this._activeTabSelector)),this._activeTabContent=this._tabsContentContainer.querySelector(".".concat(this._activeTabContentSelector))}var n,a;return n=t,(a=[{key:"_changeTab",value:function(e){this._activeTab.classList.remove(this._activeTabSelector),this._activeTabContent.classList.remove(this._activeTabContentSelector),this._activeTab=e,this._activeTabContent=this._tabsContentContainer.querySelector("#".concat(e.id)),this._activeTab.classList.add(this._activeTabSelector),this._activeTabContent.classList.add(this._activeTabContentSelector)}},{key:"setListeners",value:function(){var e=this;this._tabsList.forEach((function(t){t.addEventListener("click",(function(t){t.preventDefault(),e._changeTab(t.target)}))}))}}])&&e(n.prototype,a),Object.defineProperty(n,"prototype",{writable:!1}),t}();function n(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}var a=function(){function e(t){var n=t.baseUrl,a=t.key,r=t.headers;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._baseUrl=n,this._apiKey=a,this._headers=r}var t,a;return t=e,(a=[{key:"_checkResponse",value:function(e){return e.ok?e.json():Promise.reject(e)}},{key:"getTrends",value:function(){return fetch("".concat(this._baseUrl,"/trending?api_key=").concat(this._apiKey,"&limit=32"),{headers:this._headers}).then(this._checkResponse)}},{key:"getSearch",value:function(e){return fetch("".concat(this._baseUrl,"/search?api_key=").concat(this._apiKey,"&q=").concat(e,"&limit=32"),{headers:this._headers}).then(this._checkResponse)}},{key:"getRandomGif",value:function(){var e=this;return fetch("".concat(this._baseUrl,"/random?api_key=").concat(this._apiKey),{headers:this._headers}).then((function(t){return e._checkResponse(t)}))}},{key:"getGifById",value:function(e){var t=this;return fetch("".concat(this._baseUrl,"/").concat(e,"?api_key=").concat(this._apiKey),{headers:this._headers}).then((function(e){return t._checkResponse(e)}))}},{key:"uploadGif",value:function(e,t){var n=this,a=new Headers;a.append("Content-Type","application/x-www-form-urlencoded");var r=new URLSearchParams;r.append("source_image_url","".concat(t)),r.append("tags","".concat(e));var i={method:"POST",headers:a,body:r,redirect:"follow"};return fetch("https://upload.giphy.com/v1/gifs?api_key=".concat(this._apiKey),i).then((function(e){return n._checkResponse(e)}))}}])&&n(t.prototype,a),Object.defineProperty(t,"prototype",{writable:!1}),e}();function r(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}var i=function(){function e(t){var n=t.templateSelector,a=t.gifsListSelector,r=t.gifsItemSelector;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._templateSelector=n,this._gifsListSelector=a,this._gifsItemSelector=r}var t,n;return t=e,(n=[{key:"_getTemplate",value:function(){return document.querySelector(this._templateSelector).content.querySelector(".gifs__item").cloneNode(!0)}},{key:"generate",value:function(e){return this._gif=this._getTemplate(),this._gif.src=e,this._gif}}])&&r(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function c(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}var o=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._containerElement=document.querySelector(t),this._renderer=n}var t,n;return t=e,(n=[{key:"add",value:function(e){this._containerElement.append(e)}},{key:"renderItems",value:function(e){var t=this;e.forEach((function(e){t._renderer(e)}))}},{key:"replaceGif",value:function(e){this._containerElement.firstChild&&this._containerElement.firstChild.replaceWith(e),this._containerElement.append(e)}}])&&c(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}(),s=document.querySelector(".button_type_random-gif"),l=document.querySelector(".button_type_search"),u=document.querySelector(".search__input"),h=document.querySelector(".search__status"),f=document.querySelector(".gifs_type_search"),_=document.querySelector(".button_type_add"),d=document.querySelector(".search__input_type_add"),p=document.querySelector(".search__input_type_add-link"),y=document.querySelector(".add"),v=y.querySelector(".button_type_remove"),m=new a({baseUrl:"https://api.giphy.com/v1/gifs",key:"LgKQAIWNj0vz4nfwGHULAscH7a9nyP5R",headers:{"Content-Type":"application/json"}});new t(".navigation",".tabs-content","navigation__link_active","tab-content_active").setListeners();var b=new i({templateSelector:".template",gifsListSelector:".gifs",gifsItemSelector:".gifs__item"}),g=new o(".gifs_type_trends",(function(e){var t=C(e.images.original.url);g.add(t)})),S=new o(".gifs_type_search",(function(e){var t=C(e.images.original.url);S.add(t)})),k=new o(".gifs_type_random");function C(e){return b.generate(e)}function w(){m.getRandomGif().then((function(e){var t=C(e.data.images.original.url);t.classList.add("gifs__item_type_random"),k.replaceGif(t)})).catch((function(e){alert("".concat(e,", Что-то пошло не так, попробуйте обновить страницу"))})).finally((function(){s.textContent="Get another random gif"}))}m.getTrends().then((function(e){g.renderItems(e.data)})).catch((function(e){alert("".concat(e,", Что-то пошло не так, попробуйте обновить страницу"))})),w(),s.addEventListener("click",(function(){s.textContent="One moment...",w()}));var T=new o(".gifs_type_uploaded");y.addEventListener("submit",(function(e){e.preventDefault(),_.textContent="Adding...",m.uploadGif(d.value,p.value).then((function(e){return e.data.id})).then((function(e){m.getGifById(e).then((function(e){var t=C(e.data.images.original.url);t.classList.add("gifs__item_type_uploaded"),T.replaceGif(t)}))})).catch((function(e){alert("".concat(e,", Что-то пошло не так, попробуйте обновить страницу"))})).finally((function(){y.reset(),_.textContent="Add"}))})),v.addEventListener("click",(function(e){e.preventDefault(),v.parentElement.reset()})),l.addEventListener("click",(function(e){e.preventDefault(),f.contains(document.querySelector(".gifs__item"))&&Array.from(f.querySelectorAll(".gifs__item")).forEach((function(e){e.remove()})),h.classList.add("search__status_active"),h.textContent="Please wait...",m.getSearch(u.value).then((function(e){0===e.data.length?h.textContent="Sorry, no gifs with your name...":(h.classList.remove("search__status_active"),S.renderItems(e.data),u.value="")})).catch((function(e){alert("".concat(e,", Что-то пошло не так, попробуйте обновить страницу"))}))}))})();